---
title: "Assignment 4"
author: "Kazia Mermel"
date: "5/24/2020"
output: pdf_document
---

Overall questions:
  2c
    Do we care about the discount rate for 2c?
    Are we comparing pv or utility?


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

# Variables:
# temperature at time t
# t = time
# t_diff = T = temperature at time 100 (given)

 #overall value for T

# Givens & Vectors:

t_vector <- seq(0,200, by = 1)

```


Structure for Functions 1 - 5 is next.

```{r}
# Function 1 - Temperature(t)

temp <- function(t, t_diff){
  out = pmin((t*t_diff)/100,t_diff)
  return(out)
}


# Function 2 - Retention (t)

retention <- function(t, t_diff, B){
  out = exp(-B * (temp(t, t_diff))^2)
  return(out)
}


# Function 3 - Consumption (t)
consumption <- function(t, t_diff, B, g){
  out = retention(t, t_diff, B) * exp(g*t)
  return(out)
}


# Function 4 - Utility (C)

utility <- function(C, n){
  out = (C^(1-n))/(1-n)
  return(out)
}


# Function 5 - Discount Rate (Ramsey Rule)

r <- function(d, n, g){
  out = (d + n*g)
  return(out)
}


```


*Data Frames for Plots*

Givens for Part 1

t_diff = 5 # T
B = .05
g = .01
n = .5
d = .005   # delta

*T = 0*

```{r}
# T = 0

# Temperature df

temp_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 0))
  

# Retention df

retent_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 0,
                            B = .05)) 
# Consumption df

consum_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 0,
                              B = 0.05,
                              g = 0.01))

# Utility df

C_0 <- consum_df_T_0$consum

utility_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_0) %>% 
  mutate(utility = utility(C = C_0,
                           n = .5))
  
```

*T = 2*

```{r}
# T = 2

# Temperature df

temp_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 2)) 

# Retention df

retent_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 2,
                            B = .05)) 
# Consumption df

consum_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 2,
                              B = 0.05,
                              g = 0.01))

# Utility df

C_2 <- consum_df_T_2$consum

utility_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_2) %>% 
  mutate(utility = utility(C = C_2,
                           n = .5))
  
```

*T = 8*
```{r}
# T = 8

# Temperature df

temp_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 8))

# Retention df

retent_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 8,
                            B = .05)) 
# Consumption df

consum_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 8,
                              B = 0.05,
                              g = 0.01))

# Utility df

C_8 <- consum_df_T_8$consum

utility_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_8) %>% 
  mutate(utility = utility(C = C_8,
                           n = .5))
  
```

Question 1
```{r}
# a
# plot temperature over time
# scenario 1: no climate change


# scenario 2: moderate climate change

# scenario 3: major climate change
```


Plot 1a
```{r}
ggplot () +
  geom_point(data = temp_df_T_0,
             aes( x = t,
                  y = temp),
                  color = "blue") +
  geom_point(data = temp_df_T_2,
             aes( x = t,
                  y = temp),
                  color = "green") +
  geom_point(data = temp_df_T_8,
             aes( x = t,
                  y = temp),
                  color = "red")

             
```

Plot 1b
```{r}
ggplot () +
  geom_point(data = consum_df_T_0,
             aes( x = t,
                  y = consum),
                  color = "blue") +
  geom_point(data = consum_df_T_2,
             aes( x = t,
                  y = consum),
                  color = "green") +
  geom_point(data = consum_df_T_8,
             aes( x = t,
                  y = consum),
                  color = "red")
```



```{r}
ggplot () +
  geom_point(data = utility_df_T_0,
             aes( x = t,
                  y = utility),
                  color = "blue") +
  geom_point(data = utility_df_T_2,
             aes( x = t,
                  y = utility),
                  color = "green") +
  geom_point(data = utility_df_T_8,
             aes( x = t,
                  y = utility),
                  color = "red")
```

**Question 2a**

*T = 4.4*
```{r}
# T = 4.4
# Maintained givens from plot 1

# Temperature df

temp_df_T_4_4 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 4.4))

# Retention df

retent_df_T_4_4 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 4.4,
                            B = .05)) 
# Consumption df

consum_df_T_4_4 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 4.4,
                              B = 0.05,
                              g = 0.01))

# Utility df

C_4_4 <- consum_df_T_4_4$consum

utility_df_T_4_4 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_4_4) %>% 
  mutate(utility = utility(C = C_4_4,
                           n = .5))
  
```


Present value discounted over 200 years w/ climate change

```{r}
# Present value discounted over 200 years w/ climate change

# discount rate
r_given <- r(.005, .5, .01)

# Value calculation
pv_df_4_4 <- data.frame(t = t_vector) %>% 
  mutate(pv_4_4 = (utility_df_T_4_4$utility)/(1 + r_given)^(t_vector))

pv_4_4 = sum(pv_df_4_4$pv_4_4)

```

Present value discounted over 200 years w/o climate change
```{r}
# Present value discounted over 200 years w/o climate change

# Value calculation
pv_df_0 <- data.frame(t = t_vector) %>% 
  mutate(pv_0 = (utility_df_T_0$utility)/(1 + r_given)^(t_vector))

pv_0 = sum(pv_df_0$pv_0)

```

Percentage Loss (L)
```{r}

L_cc <- abs(pv_0-pv_4_4)/pv_0 * 100


```

Plots for visualization


```{r}
ggplot () +
  geom_point(data = utility_df_T_0,
             aes( x = t,
                  y = utility),
                  color = "blue") +
  geom_point(data = utility_df_T_4_4,
             aes( x = t,
                  y = utility),
                  color = "green") 
```





**Question 2b**


```{r}

```



**Question 2c**




















