---
title: "Assignment 4"
author: "Kazia Mermel"
date: "5/24/2020"
output: pdf_document
---

Overall questions:


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

# Variables:
# temperature at time t
# t = time
# t_diff = T = temperature at time 100 (given)

 #overall value for T

# Givens & Vectors:

t_vector <- seq(0,200, by = 1)

```


Structure for Functions 1 - 5 is next.

```{r}
# Function 1 - Temperature(t)

temp <- function(t, t_diff){
  out = pmin((t*t_diff)/100,t_diff)
  return(out)
}


# Function 2 - Retention (t)

retention <- function(t, t_diff, B){
  out = exp(-B * (temp(t, t_diff))^2)
  return(out)
}


# Function 3 - Consumption (t)
consumption <- function(t, t_diff, B, g){
  out = retention(t, t_diff, B) * exp(g*t)
  return(out)
}


# Function 4 - Utility (C)

utility <- function(C, n){
  out = (C^(1-n))/(1-n)
  return(out)
}


# Function 5 - Discount Rate (Ramsey Rule)

r <- function(d, n, g){
  out = (d + n*g)
  return(out)
}


```


*Data Frames for Plots*

Givens for Part 1

t_diff = 5 # T
B = .05
g = .01
n = .5
d = .005   # delta

*T = 0*

```{r}
# T = 0

# Temperature df

temp_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 0))
  

# Retention df

retent_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 0,
                            B = .05)) 
# Consumption df

consum_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 0,
                              B = 0.05,
                              g = 0.1))

# Utility df

C_0 <- consum_df_T_0$consum

utility_df_T_0 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_0) %>% 
  mutate(utility = utility(C = C_0,
                           n = .5))
  
```

*T = 2*

```{r}
# T = 2

# Temperature df

temp_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 2)) 

# Retention df

retent_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 2,
                            B = .05)) 
# Consumption df

consum_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 2,
                              B = 0.05,
                              g = 0.1))

# Utility df

C_2 <- consum_df_T_2$consum

utility_df_T_2 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_2) %>% 
  mutate(utility = utility(C = C_2,
                           n = .5))
  
```

*T = 8*
```{r}
# T = 8

# Temperature df

temp_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(temp = temp(t_vector,
                     t_diff = 8))

# Retention df

retent_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(retent = retention(t_vector,
                            t_diff = 8,
                            B = .05)) 
# Consumption df

consum_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(consum = consumption(t_vector,
                              t_diff = 8,
                              B = 0.05,
                              g = 0.1))

# Utility df

C_8 <- consum_df_T_8$consum

utility_df_T_8 <- data.frame(t = t_vector) %>% 
  mutate(consum = C_8) %>% 
  mutate(utility = utility(C = C_8,
                           n = .5))
  
```

Question 1
```{r}
# a
# plot temperature over time
# scenario 1: no climate change


# scenario 2: moderate climate change

# scenario 3: major climate change
```


Plot 1a
```{r}
ggplot () +
  geom_point(data = temp_df_T_0,
             aes( x = t,
                  y = temp),
                  color = "blue") 
               
             
```























Initial code from first discussion I didn't want to delete without talking to y'all - GEM

T_0_df <- data.frame(t = t_vector) %>% 
  mutate(tau = temp(t_vector))# %>% 
 # mutate(K = retention(t_vector, temp) )



# fraction of economic activity retained in a year
# r = temperature at time t
# B = some constant we're given
retention = function(t, temp, B)
{out = exp(-B*temp^2)
return(out)}

retention(t = 10, r = temp(t = 50, T = 5), B = 0.05)

# economic activity
# g = some other constant
# K = retention of economic activity in a year
consumption = function(t, g, K)
{out = K*exp(g*t)
return(out)}

consumption(t = 10, g = 0.01, K = retention(t = 10, r = temp(t = 50, T = 5), B = 0.05))

# utility from consumption
# C = consumption
# n = some constant
utility = function(C, n)
{out = C^(1-n)/(1-n)
return(out)}

utility(C = consumption(t = 10, g = 0.01, K = retention(t = 10, r = temp(t = 50, T = 5), B = 0.05)), n = 0.5)

# discount rate, based on Ramsey Rule
# d = delta aka some constant
# n and g are both constants we're given
discount = function(d,n, g)
{out = d + n*g
return(out)}

discount(d = 0.005, n = 0.5, g = 0.01)




